# 安全登录系统使用说明

## 系统概述

新的登录系统使用 bcrypt 加密技术来保护用户密码，确保源代码中不会暴露明文密码。

## 文件结构

```
login/
├── Login.vue          # 登录页面组件（已更新）
├── auth.js            # 认证管理器
├── config.json        # 用户配置（加密存储）
├── init_password.js   # 密码初始化工具
└── helper.js          # 辅助函数
```

## 安全特性

1. **密码加密**: 使用 bcrypt 算法对密码进行哈希加密
2. **盐值保护**: 每个密码都使用随机盐值进行加密
3. **会话管理**: 支持会话超时和自动过期
4. **配置分离**: 用户信息存储在独立的配置文件中

## 使用方法

### 1. 安装依赖

```bash
npm install bcryptjs
```

### 2. 初始化密码

首次使用时，需要运行密码初始化工具：

```bash
cd docs/.vuepress/login
node init_password.js
```

**注意**: 初始化完成后请删除 `init_password.js` 文件以确保安全。

### 3. 添加新用户

编辑 `config.json` 文件，在 `users` 数组中添加新用户：

```json
{
  "username": "新用户名",
  "passwordHash": "需要先运行初始化工具生成",
  "role": "user"
}
```

### 4. 修改密码

如果需要修改密码，可以：

1. 临时恢复 `init_password.js` 文件
2. 修改文件中的默认密码
3. 运行初始化工具
4. 再次删除初始化工具文件

## 配置说明

### config.json 结构

```json
{
  "users": [
    {
      "username": "用户名",
      "passwordHash": "加密后的密码哈希",
      "role": "用户角色"
    }
  ],
  "security": {
    "saltRounds": 10, // 加密强度
    "sessionTimeout": 3600000 // 会话超时时间（毫秒）
  }
}
```

## 安全建议

1. **保护配置文件**: 确保 `config.json` 文件不会被公开访问
2. **定期更换密码**: 建议定期更新用户密码
3. **删除初始化工具**: 初始化完成后务必删除 `init_password.js`
4. **备份配置**: 定期备份用户配置文件

## 故障排除

### 登录失败

- 检查 `bcryptjs` 依赖是否已安装
- 确认配置文件路径正确
- 验证密码哈希是否正确生成

### 依赖问题

如果遇到模块找不到错误，请运行：

```bash
npm install
```

## 技术细节

- 使用 bcrypt 算法进行密码哈希
- 支持异步密码验证
- 包含会话管理和超时控制
- 提供完整的错误处理机制
