# 官网搭建流程（前端）

**时间：** 2024-11-11

已完成【官网项目】的基础搭建工作，并运行验证相关 DEMO（比如多端适配功能、图片轮播功能、CSS3 动画功能等），Gitlab 的仓库地址为：[https://gl.szzbn.cn/FE/szzbn-web.git](https://gl.szzbn.cn/FE/szzbn-web.git)。

---

## 一、具体搭建流程

**官网地址：** [https://nuxt.com/](https://nuxt.com/) （[https://nuxt.com.cn/](https://nuxt.com.cn/)）

### 1.1 脚手架生成初始化项目

```bash
# 此方式引入的是VUE2版本
npx create-nuxt-app [my-website]

# 升级yarn版本
yarn set version berry

# 此方式引入的是VUE3和Nuxt3版本
yarn dlx nuxi@latest init <project-name>

# 具体创建项目示例
yarn dlx nuxi@latest init zbn-web
```

### 1.2 引入 Sass

```bash
# VUE2写法
npm install --save-dev sass sass-loader@10 fibers

# VUE3写法
npm install -D sass-embedded
```

### 1.3 配置多端适配逻辑

#### 1.3.1 使用媒体查询功能

```css
/* 在 assets/css/global.css 或 global.scss 中 */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
}

/* 适配移动端 */
@media (max-width: 768px) {
  /* 调整小屏幕下的样式 */
  background: #88d2f7;
}

/* 适配平板 */
@media (min-width: 769px) and (max-width: 1024px) {
  /* 调整平板设备样式 */
  background: #f8b080;
}

/* 适配PC端 */
@media (min-width: 1025px) {
  /* 调整大屏幕样式 */
  background: #e2e0e0;
}
```

#### 1.3.2 使用 @nuxtjs/device 插件

```vue
<script setup>
import { ref, onMounted, getCurrentInstance, onUnmounted } from 'vue';

const isMobile = ref(false);

const checkDevice = () => {
  // 检测当前窗口宽度
  isMobile.value = window.innerWidth <= 768; // 768 作为移动端的宽度临界值
};

onMounted(() => {
  checkDevice(); // 初始化时检查设备类型
  window.addEventListener('resize', checkDevice); // 添加监听事件
  const instance = getCurrentInstance();
  const $device = instance?.proxy.$device;
  // 检测设备
  if ($device) {
    isMobile.value = $device.isMobile;
  }
});

onUnmounted(() => {
  window.removeEventListener('resize', checkDevice); // 组件卸载时移除监听事件
});
</script>
```

### 1.4 引入轮播插件

```bash
yarn add swiper
```

**官网文档：** [https://swiperjs.com/vue](https://swiperjs.com/vue)

### 1.5 引入 CSS3 动画插件

```bash
npm install animate.css
```

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  css: [
    'animate.css/animate.min.css', // 引入 Animate.css 样式
  ],
});
```

---

## 二、注意事项

### 2.1 注意 sass-loader 与 webpack 的版本兼容性问题

**解决方案：** 指定特定的 sass-loader 版本，`sass-loader@10`。

### 2.2 注意多端适配时，要结合媒体查询以及设备判断两种方案

**解决方案：** 两种方案结合，并需要将设备判断封装为工具函数。

```typescript
// utils/deviceType.ts
import { ref, onMounted, onUnmounted, Ref } from 'vue';

type DeviceType = 'mobile' | 'tablet' | 'desktop';

export function useDeviceType(): { deviceType: Ref<DeviceType> } {
  const deviceType = ref<DeviceType>('desktop'); // 初始化为 'desktop'

  const checkDeviceType = (): void => {
    const width = window.innerWidth;
    if (width <= 768) {
      deviceType.value = 'mobile';
    } else if (width >= 769 && width <= 1024) {
      deviceType.value = 'tablet';
    } else {
      deviceType.value = 'desktop';
    }
  };

  onMounted(() => {
    checkDeviceType(); // 初始化时检查设备类型
    window.addEventListener('resize', checkDeviceType); // 监听窗口变化
  });

  onUnmounted(() => {
    window.removeEventListener('resize', checkDeviceType); // 组件卸载时移除监听
  });

  return { deviceType };
}
```

---

## 三、运行 DEMO

本 DEMO 主要通过不同的设备判断来展示效果（背景色不同、显示内容不同），用于验证多端适配功能。

### 3.1 PC 端（展示灰色背景）

![An image](/images/FE/website-1.png)

### 3.2 平板（展示橙色背景）

![An image](/images/FE/website-2.png)

### 3.3 移动端（展示蓝色背景）

![An image](/images/FE/website-3.png)
